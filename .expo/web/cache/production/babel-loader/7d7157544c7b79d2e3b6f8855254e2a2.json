{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Date.prototype.toString.call(Reflect.construct(Date,[],function(){}));return true;}catch(e){return false;}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}import*as React from'react';import View from\"react-native-web/dist/exports/View\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{NavigationHelpersContext,useTheme}from'@react-navigation/native';import{ScreenContainer}from'react-native-screens';import SafeAreaProviderCompat from\"./SafeAreaProviderCompat\";import ResourceSavingScene from\"./ResourceSavingScene\";import BottomTabBar from\"./BottomTabBar\";function SceneContent(_ref){var isFocused=_ref.isFocused,children=_ref.children;var _useTheme=useTheme(),colors=_useTheme.colors;return React.createElement(View,{accessibilityElementsHidden:!isFocused,importantForAccessibility:isFocused?'auto':'no-hide-descendants',style:[styles.content,{backgroundColor:colors.background}]},children);}var BottomTabView=function(_React$Component){_inherits(BottomTabView,_React$Component);var _super=_createSuper(BottomTabView);function BottomTabView(){var _this;_classCallCheck(this,BottomTabView);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_defineProperty(_assertThisInitialized(_this),\"state\",{loaded:[_this.props.state.index]});_defineProperty(_assertThisInitialized(_this),\"renderTabBar\",function(){var _this$props=_this.props,_this$props$tabBar=_this$props.tabBar,tabBar=_this$props$tabBar===void 0?function(props){return React.createElement(BottomTabBar,props);}:_this$props$tabBar,tabBarOptions=_this$props.tabBarOptions,state=_this$props.state,navigation=_this$props.navigation,descriptors=_this$props.descriptors;return tabBar(_objectSpread(_objectSpread({},tabBarOptions),{},{state:state,descriptors:descriptors,navigation:navigation}));});return _this;}_createClass(BottomTabView,[{key:\"render\",value:function render(){var _this$props2=this.props,state=_this$props2.state,descriptors=_this$props2.descriptors,navigation=_this$props2.navigation,lazy=_this$props2.lazy;var routes=state.routes;var loaded=this.state.loaded;return React.createElement(NavigationHelpersContext.Provider,{value:navigation},React.createElement(SafeAreaProviderCompat,null,React.createElement(View,{style:styles.container},React.createElement(ScreenContainer,{style:styles.pages},routes.map(function(route,index){var descriptor=descriptors[route.key];var unmountOnBlur=descriptor.options.unmountOnBlur;var isFocused=state.index===index;if(unmountOnBlur&&!isFocused){return null;}if(lazy&&!loaded.includes(index)&&!isFocused){return null;}return React.createElement(ResourceSavingScene,{key:route.key,style:StyleSheet.absoluteFill,isVisible:isFocused},React.createElement(SceneContent,{isFocused:isFocused},descriptor.render()));})),this.renderTabBar())));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(nextProps,prevState){var index=nextProps.state.index;return{loaded:prevState.loaded.includes(index)?prevState.loaded:[].concat(_toConsumableArray(prevState.loaded),[index])};}}]);return BottomTabView;}(React.Component);export{BottomTabView as default};_defineProperty(BottomTabView,\"defaultProps\",{lazy:true});var styles=StyleSheet.create({container:{flex:1,overflow:'hidden'},pages:{flex:1},content:{flex:1}});","map":{"version":3,"sources":["BottomTabView.tsx"],"names":["children","colors","useTheme","isFocused","styles","backgroundColor","background","BottomTabView","React","lazy","index","nextProps","loaded","prevState","tabBar","props","descriptors","state","navigation","routes","container","pages","descriptor","route","unmountOnBlur","StyleSheet","flex","overflow","content"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { View, StyleSheet } from 'react-native';\n\nimport {\n  NavigationHelpersContext,\n  TabNavigationState,\n  useTheme,\n} from '@react-navigation/native';\nimport { ScreenContainer } from 'react-native-screens';\n\nimport SafeAreaProviderCompat from './SafeAreaProviderCompat';\nimport ResourceSavingScene from './ResourceSavingScene';\nimport BottomTabBar from './BottomTabBar';\nimport type {\n  BottomTabNavigationConfig,\n  BottomTabDescriptorMap,\n  BottomTabNavigationHelpers,\n  BottomTabBarProps,\n} from '../types';\n\ntype Props = BottomTabNavigationConfig & {\n  state: TabNavigationState;\n  navigation: BottomTabNavigationHelpers;\n  descriptors: BottomTabDescriptorMap;\n};\n\ntype State = {\n  loaded: number[];\n};\n\nfunction SceneContent({\n  isFocused,\n  children,\n}: {\n  isFocused: boolean;\n  children: React.ReactNode;\n}) {\n  const { colors } = useTheme();\n\n  return (\n    <View\n      accessibilityElementsHidden={!isFocused}\n      importantForAccessibility={isFocused ? 'auto' : 'no-hide-descendants'}\n      style={[styles.content, { backgroundColor: colors.background }]}\n    >\n      {children}\n    </View>\n  );\n}\n\nexport default class BottomTabView extends React.Component<Props, State> {\n  static defaultProps = {\n    lazy: true,\n  };\n\n  static getDerivedStateFromProps(nextProps: Props, prevState: State) {\n    const { index } = nextProps.state;\n\n    return {\n      // Set the current tab to be loaded if it was not loaded before\n      loaded: prevState.loaded.includes(index)\n        ? prevState.loaded\n        : [...prevState.loaded, index],\n    };\n  }\n\n  state = {\n    loaded: [this.props.state.index],\n  };\n\n  private renderTabBar = () => {\n    const {\n      tabBar = (props: BottomTabBarProps) => <BottomTabBar {...props} />,\n      tabBarOptions,\n      state,\n      navigation,\n      descriptors,\n    } = this.props;\n    return tabBar({\n      ...tabBarOptions,\n      state: state,\n      descriptors: descriptors,\n      navigation: navigation,\n    });\n  };\n\n  render() {\n    const { state, descriptors, navigation, lazy } = this.props;\n    const { routes } = state;\n    const { loaded } = this.state;\n\n    return (\n      <NavigationHelpersContext.Provider value={navigation}>\n        <SafeAreaProviderCompat>\n          <View style={styles.container}>\n            <ScreenContainer style={styles.pages}>\n              {routes.map((route, index) => {\n                const descriptor = descriptors[route.key];\n                const { unmountOnBlur } = descriptor.options;\n                const isFocused = state.index === index;\n\n                if (unmountOnBlur && !isFocused) {\n                  return null;\n                }\n\n                if (lazy && !loaded.includes(index) && !isFocused) {\n                  // Don't render a screen if we've never navigated to it\n                  return null;\n                }\n\n                return (\n                  <ResourceSavingScene\n                    key={route.key}\n                    style={StyleSheet.absoluteFill}\n                    isVisible={isFocused}\n                  >\n                    <SceneContent isFocused={isFocused}>\n                      {descriptor.render()}\n                    </SceneContent>\n                  </ResourceSavingScene>\n                );\n              })}\n            </ScreenContainer>\n            {this.renderTabBar()}\n          </View>\n        </SafeAreaProviderCompat>\n      </NavigationHelpersContext.Provider>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    overflow: 'hidden',\n  },\n  pages: {\n    flex: 1,\n  },\n  content: {\n    flex: 1,\n  },\n});\n"]},"metadata":{},"sourceType":"module"}